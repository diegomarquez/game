<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Common Game-Builder Errors</title>
        <link rel="stylesheet" type="text/css" href="styles/override.css">

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
        <script src="bower_components/mustache/mustache.js"></script>
        <script src="bower_components/stringjs/lib/string.js"></script>
        <script id="template" type="x-tmpl-mustache">
            {{#errors}}
                <div class='blue-background'>
                    <hr>
                    <div class="row">
                        {{#docLink}}
                            <a href={{docLink}} name={{name}}>
                                <h4 class="text-center col-md-6 col-md-offset-3">{{humanName}}</h4>
                            </a>
                        {{/docLink}}

                        {{^docLink}}
                            <a name={{name}}>
                                <h4 class="text-center col-md-6 col-md-offset-3">{{humanName}}</h4>
                            </a>
                        {{/docLink}}
                    </div>
                    <hr>
                </div>

                {{#entries}}
                <p class="left-padding right-padding text-center orange-text">{{humanName}} => {{title}}</p>
                <p class="left-padding right-padding">{{description}}</p>
                {{#divider}}
                <hr class="divider">
                {{/divider}}
                {{/entries}}    
            {{/errors}}
        </script>
    </head>
   <body>
        <div class="container">
            <div class="jumbotron">
                <h1 class="text-center" class="page-header">Errors
                    <hr>
                    <small>Common errors thrown by <a href="index.html" >GAME-BUILDER</a> and explanations on why you are seeing them</small>
                </h1>
            </div>
                
            <div id="template">
            </div>


            <hr>
            <h6 class="left-padding right-padding footer text-center">Hopefully this is usefull information.</h6>
            <hr>

            <div class="left-padding right-padding footer text-center">
                <p>A project by 
                    <a href="https://github.com/diegomarquez">Diego Enrique Marquez</a>
                </p>
            </div>
        </div>

        <script>
            $(function() {
                var template = $('#template').html();
                Mustache.parse(template); 

                $.getJSON("error.json", function(data) {
                    $.getJSON("game-builder-dictionary.json", function(links) {
                        for(var i=0; i<data.errors.length; i++) {            
                            var error = data.errors[i];

                            error.humanName = S(error.name).humanize().s;

                            if(error.docLink != "") {
                                error.docLink = error.docLink.replace(error.docLink, links[error.docLink]);
                            }

                            for(var j=0; j<error.entries.length; j++) {
                                entry = error.entries[j];
                                entry.divider = j < error.entries.length - 1;
                            }
                        }

                        var rendered = Mustache.render(template, data);
                        
                        for(var k in links) {
                            rendered = rendered.replace(new RegExp(k, 'g'), "<a href='" + links[k] + "'><strong class='red-text'>" + S(k.replace("@@", "")).humanize().s + "</strong></a>");
                        }

                        $('div#template').html(S(rendered).trim().s);
                    });
                });
            })
        </script>
    </body>
</html>