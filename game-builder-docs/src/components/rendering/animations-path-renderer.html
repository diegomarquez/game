<!DOCTYPE html><html lang="en"><head><title>src/components/rendering/animations-path-renderer</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="src/components/rendering/animations-path-renderer"><meta name="groc-project-path" content="work/game-builder/src/components/rendering/animations-path-renderer.js"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">work/game-builder/src/components/rendering/animations-path-renderer.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="animations-path-rendererjs">animations-path-renderer.js</h1>

<h3 id="bydiegoenriquemarquezhttpwwwtreintipollocom">By <a href="http://www.treintipollo.com">Diego Enrique Marquez</a></h3>

<h3 id="findmeongithubhttpsgithubcomdiegomarquez"><a href="https://github.com/diegomarquez">Find me on Github</a></h3>

<p>Inherits from: 
<a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/components/rendering/renderer.html">renderer</a></p>

<p>Depends of: 
<a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/debug/error-printer.html">error-printer</a></p>

<p>A <a href="http://requirejs.org/">requireJS</a> module. For use with <a href="http://diegomarquez.github.io/game-builder">Game-Builder</a></p>

<p>This module is similar to <a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/components/rendering/animation-path-renderer.html">animation-path-renderer</a>, with the difference that it assumes less things
about the arguments passed. It needs more configuration with the benefit of more control.</p>

<p>Frames are not assumed to be part of a single continues animation, as such you need to configure which frames will belong to which animation.
You are then able to play, stop and resume each of this animations individually through a label passed into these methods.</p>

<pre><code class=" javascript">gb.coPool.createConfiguration("PathAnimations", 'Path_Animations_Renderer')
     .args({ 
         //This name is used to identify the cached drawings
         //This is required
        name: 'RendererName',

        //These set the total width and height of the paths in the animation
        //This argument is only required if the renderer does not provide it. 
        width: 100,
        height: 100,

        //These number defines the amount of time that each frame will be displayed.
        //It is in seconds and it is required
        frameDelay: 0.1,

        //Each element of this array defines a frame of animation
        //It is required and can have as many elements as needed
        framePaths: [
            function(context) {
                draw.rectangle(context, 0, 0, 70, 30, "#FF0000", null, 1);
            },
            function(context) {
                draw.rectangle(context, 0, 0, 70, 30, "#00FF00", null, 1);
            },
            function(context) {
                draw.rectangle(context, 0, 0, 70, 30, "#0000FF", null, 1);
            },
            function(context) {
                draw.rectangle(context, 0, 0, 70, 30, "#FFFFFF", null, 1);
            },
            function(context) {
                draw.rectangle(context, 0, 0, 70, 30, "#00FFFF", null, 1);
            }
        ],

        //The label with which to start
        //This is required
        startingLabel: 'startLabel',

        //This object defines animations using the frames defined previously.
        //The object can have as many entries as needed and it is required
        labels: {
            //Name of the label
            'startLabel': {
                //If the label is a looping animation
                loop: true, 
                //Indexes of the frames this animation uses
                frames: [0, 1, 2],
            }
        },

         //Use this if you want the registration point of the image to be the center
         //This is optional
        offset:'center',

        //If offset is not provided this two are used
        //These are optional and default to 0
        offsetX:0,
        offsetY:0, 
});
</code></pre>

<p><strong>Note: The snippet uses the reference to the <a href=http://diegomarquez.github.io/game-builder/game-builder-docs/src/pools/component-pool.html>component-pool</a>
found in the <a href=http://diegomarquez.github.io/game-builder/game-builder-docs/src/gb.html>gb</a> module. 
The way you get a hold to a reference to the <a href=@@csomponent-pool@@>component-pool</a>
may vary.</strong></p>

<p>These objects extend <a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/delegate.html">delegate</a> so they provide a few events to hook into:</p>

<h3 id="complete"><strong>COMPLETE</strong></h3>

<p>When the current label reaches the last frame and it doesn't loop</p>

<pre><code class=" javascript  ">gameObject.renderer.on(gameObject.renderer.COMPLETE, function() {});
</code></pre>

<h3 id="loop"><strong>LOOP</strong></h3>

<p>When the current label reaches the last frame and it loops</p>

<pre><code class=" javascript  ">gameObject.renderer.on(gameObject.renderer.LOOP, function() {});
</code></pre></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="slightly-more-complicated-animations">Slightly more complicated animations</h2></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper"><span class="nx">define</span><span class="p">([</span><span class="s2">&quot;animation-path-renderer&quot;</span><span class="p">,</span> <span class="s2">&quot;error-printer&quot;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">AnimationPathRenderer</span><span class="p">,</span> <span class="nx">ErrorPrinter</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">AnimationsPathRenderer</span> <span class="o">=</span> <span class="nx">AnimationPathRenderer</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>start</strong></p>

<p>This is called by the <a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/hierarchy/game-object.html">game-object</a> using this renderer.
It caches all the resutls from calling the drawing methods in the <strong>framePaths</strong> array</p>

<p><strong>Can throw an Error</strong><br/>(If width, height, name, frameDelay or framePaths properties are not set)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">labels</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ErrorPrinter</span><span class="p">.</span><span class="nx">missingArgumentError</span><span class="p">(</span><span class="s1">&#39;Animation Path Renderer&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">startingLabel</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ErrorPrinter</span><span class="p">.</span><span class="nx">missingArgumentError</span><span class="p">(</span><span class="s1">&#39;Animation Path Renderer&#39;</span><span class="p">,</span> <span class="s1">&#39;startingLabel&#39;</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentLabel</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>update</strong></p>

<p>Executes the logic needed to change frames</p>

<p>Parameters:</p>

<ul>
<li><strong>delta must be a Number.</strong><br/>(The time between the current update and the last)</li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="nx">update</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">delta</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isPlaying</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">delayTotal</span> <span class="o">+=</span> <span class="nx">delta</span><span class="p">;</span>

          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">delayTotal</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">frameDelay</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">delayTotal</span> <span class="o">-=</span> <span class="k">this</span><span class="p">.</span><span class="nx">frameDelay</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">frameIndex</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">frameIndex</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">loop</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">COMPLETE</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentLabel</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">pause</span><span class="p">();</span>
              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">frameIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">LOOP</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentLabel</span><span class="p">);</span>
              <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">currentFrameName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">frameIndex</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>play</strong></p>

<p>Plays the animation defined by the specified label</p>

<p>Parameters:</p>

<ul>
<li><strong>selectedLabel must be a String.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="nx">play</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selectedLabel</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">selectedLabel</span> <span class="o">=</span> <span class="nx">selectedLabel</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">startingLabel</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">label</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">labels</span><span class="p">[</span><span class="nx">selectedLabel</span><span class="p">];</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">currentLabel</span> <span class="o">=</span> <span class="nx">label</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span> <span class="o">=</span> <span class="nx">label</span><span class="p">.</span><span class="nx">frames</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="nx">label</span><span class="p">.</span><span class="nx">loop</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">delayTotal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">frameIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentFrameName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">isPlaying</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>loop</strong></p>

<p>Forces a label to loop</p>

<p>Parameters:</p>

<ul>
<li><strong>selectedLabel must be a String.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="nx">loop</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selectedLabel</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">selectedLabel</span> <span class="o">=</span> <span class="nx">selectedLabel</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">startingLabel</span><span class="p">;</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">currentLabel</span> <span class="o">=</span> <span class="nx">label</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span> <span class="o">=</span> <span class="nx">label</span><span class="p">.</span><span class="nx">frames</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">delayTotal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">frameIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentFrameName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">isPlaying</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>stop</strong></p>

<p>Stops and resets the animation to the beginning of the specified label</p>

<p>Parameters:</p>

<ul>
<li><strong>selectedLabel must be a String.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="nx">stop</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selectedLabel</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">selectedLabel</span> <span class="o">=</span> <span class="nx">selectedLabel</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">startingLabel</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">label</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">labels</span><span class="p">[</span><span class="nx">selectedLabel</span><span class="p">];</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">currentLabel</span> <span class="o">=</span> <span class="nx">label</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span> <span class="o">=</span> <span class="nx">label</span><span class="p">.</span><span class="nx">frames</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">delayTotal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">frameIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentFrameName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentFrames</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">isPlaying</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p style='color:#AD071D'><strong>pause</strong></p>

<p>Pauses the current label in the current frame</p></div></div><div class="code"><div class="wrapper">    <span class="nx">pause</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">isPlaying</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">  <span class="p">});</span>

  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">AnimationsPathRenderer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;LOOP&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;loop&#39;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="k">return</span> <span class="nx">AnimationsPathRenderer</span><span class="p">;</span>
<span class="p">});</span></div></div></div></div></body></html>