<!DOCTYPE html><html lang="en"><head><title>src/timers/timer-factory</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../"><meta name="groc-document-path" content="src/timers/timer-factory"><meta name="groc-project-path" content="work/game-builder/src/timers/timer-factory.js"><link rel="stylesheet" type="text/css" media="all" href="../../assets/style.css"><script type="text/javascript" src="../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">work/game-builder/src/timers/timer-factory.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="timer-factoryjs">timer-factory.js</h1>

<h3 id="bydiegoenriquemarquezhttpwwwtreintipollocom">By <a href="http://www.treintipollo.com">Diego Enrique Marquez</a></h3>

<h3 id="findmeongithubhttpsgithubcomdiegomarquez"><a href="https://github.com/diegomarquez">Find me on Github</a></h3>

<p>Inherits from:
<a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/delegate.html">delegate</a></p>

<p>Depends of: 
<a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/timers/timer.html">timer</a>
<a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/debug/error-printer.html">error-printer</a></p>

<p>A <a href="http://requirejs.org/">requireJS</a> module. For use with <a href="http://diegomarquez.github.io/game-builder">Game-Builder</a> </p>

<p>This module provides a factory to create <a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/timers/timer.html">timer</a> objects. Asides from creating them it provides methods
to manipulate them in bulk.</p>

<h3 id="thetimerfactoryobjectextendsdelegatehttpdiegomarquezgithubiogamebuildergamebuilderdocssrcdelegatehtmlsoitprovidesafeweventstohookinto">The Timer Factory object extends <a href="http://diegomarquez.github.io/game-builder/game-builder-docs/src/delegate.html">delegate</a> so it provides a few events to hook into:</h3>

<h3 id="create"><strong>create</strong></h3>

<p>When a timer is created and added to the factory registry</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.CREATE, function(timer) {});
</code></pre>

<h3 id="remove"><strong>remove</strong></h3>

<p>When a timer is removed from the factory registry</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.REMOVE, function(timer) {});
</code></pre>

<h3 id="complete"><strong>complete</strong></h3>

<p>When a timer completes</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.COMPLETE, function(timer) {});
</code></pre>

<h3 id="repeate"><strong>repeate</strong></h3>

<p>When a timer repeates</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.REPEATE, function(timer) {});
</code></pre>

<h3 id="start"><strong>start</strong></h3>

<p>When a timer starts</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.START, function(timer) {});
</code></pre>

<h3 id="pause"><strong>pause</strong></h3>

<p>When a timer pauses</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.PAUSE, function(timer) {});
</code></pre>

<h3 id="resume"><strong>resume</strong></h3>

<p>When a timer resumes</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.RESUME, function(timer) {});
</code></pre>

<h3 id="reset"><strong>reset</strong></h3>

<p>When a timer is reset</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.RESET, function(timer) {});
</code></pre>

<h3 id="stop"><strong>stop</strong></h3>

<p>When a timer is stops</p>

<pre><code class=" javascript  ">timerFactory.on(timerFactory.STOP, function(timer) {});
</code></pre></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="manage-timers">Manage Timers</h2></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper"><span class="nx">define</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">ErrorPrinter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;error-printer&#39;</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">TimerFactory</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;delegate&#39;</span><span class="p">).</span><span class="nx">extend</span><span class="p">({</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p style='color:#AD071D'><strong>init</strong></p>

<p>Constructor</p></div></div><div class="code"><div class="wrapper">    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">timeOuts</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>get</strong></p>

<p>Creates a new instance of a Timer.</p>

<p>After creating it, it saves it into an array. It will also create a property in the <strong>owner</strong> 
giving it the name <strong>propertyName</strong>. </p>

<p>Parameters:</p>

<ul>
<li><p><strong>owner must be an Object.</strong><br/>(Object in which the method was called in. Common value is <em>'this'</em>)</p></li>
<li><p><strong>name must be a String.</strong><br/>(An identifier for the Timer)</p></li>
<li><p><strong>propertyName must be a String.</strong><br/>(Name of the property the timer will be added in <strong>owner</strong>.)</p></li>
</ul>

<p><strong>Can throw an Error</strong><br/>(If the owner already has a property with the value of <strong>propertyName</strong>)<br/><strong>and</strong> <strong>Can throw an Error</strong><br/>(If owner is not passed as argument)<br/><strong>and</strong> <strong>Can throw an Error</strong><br/>(If name is not passed as argument)<br/><strong>and</strong> <strong>Can throw an Error</strong><br/>(If propertyName is not passed as a )</p></div></div><div class="code"><div class="wrapper">    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">propertyName</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">owner</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">propertyName</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">ErrorPrinter</span><span class="p">.</span><span class="nx">printError</span><span class="p">(</span><span class="s1">&#39;Timer Factory&#39;</span><span class="p">,</span> <span class="s1">&#39;This owner is already using this property, assigning it again with a timer might cause your program to go ape shit.&#39;</span><span class="p">);</span>
      <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">owner</span><span class="p">)</span> <span class="p">{</span> 
          <span class="nx">ErrorPrinter</span><span class="p">.</span><span class="nx">printError</span><span class="p">(</span><span class="s1">&#39;Timer Factory&#39;</span><span class="p">,</span> <span class="s1">&#39;Timer must have an owner, if unsure just send in &quot;this&quot;&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> 
          <span class="nx">ErrorPrinter</span><span class="p">.</span><span class="nx">printError</span><span class="p">(</span><span class="s1">&#39;Timer Factory&#39;</span><span class="p">,</span> <span class="s1">&#39;Timer must have an name to identify it later&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">propertyName</span><span class="p">)</span> <span class="p">{</span> 
          <span class="nx">ErrorPrinter</span><span class="p">.</span><span class="nx">printError</span><span class="p">(</span><span class="s1">&#39;Timer Factory&#39;</span><span class="p">,</span> <span class="s1">&#39;Timer must have a propertyName to be refered with from its owners scope&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">timerConstructor</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;timer&#39;</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">timerConstructor</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">propertyName</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">timeout</span><span class="p">);</span>
        <span class="nx">owner</span><span class="p">[</span><span class="nx">propertyName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">timeout</span><span class="p">;</span>  

        <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">CREATE</span><span class="p">,</span> <span class="nx">timeout</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Remove the timer from the factory when it's REMOVE event is fired</p></div></div><div class="code"><div class="wrapper">        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">REMOVE</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">index</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">REMOVE</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">START</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">START</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">COMPLETE</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">COMPLETE</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">REPEATE</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">REPEATE</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">PAUSE</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">PAUSE</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">RESUME</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">RESUME</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">RESET</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">RESET</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">timeout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">timeout</span><span class="p">.</span><span class="nx">STOP</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">STOP</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>getTotalCount</strong></p>

<p><strong>Returns a Number</strong><br/>(The total amount of timers)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">getTotalCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>getRunningCount</strong></p>

<p><strong>Returns a Number</strong><br/>(The amount of timers currently in a running state)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">getRunningCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">getCountInState</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;Running&#39;</span><span class="p">);</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>getPausedCount</strong></p>

<p><strong>Returns a Number</strong><br/>(The amount of timers currently in a paused state)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">getPausedCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">getCountInState</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;Paused&#39;</span><span class="p">);</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>getStoppedCount</strong></p>

<p><strong>Returns a Number</strong><br/>(The amount of timers currently in a stopped state)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">getStoppedCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">getCountInState</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;Stopped&#39;</span><span class="p">);</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>These methods are pretty obvious in what they do. They are meant to apply a state to all registered timers
at the same time. Usefull to handle global state of an application.</p>

<p>For instance, if the application looses focus, you probably want to pause all timers, regardless of what they are doing
and to which part of the code base they belong to.</p>

<p>After gaining focus, you can resume them all together. Pretty usefull.</p>

<p>Although the names suggest obvious behaviour, the usage is not so obvious. Take a look at the object returned by <strong>getChangeObject</strong>
to see how to you can control timers in bulk.</p></div></div><div class="code"><div class="wrapper">    <span class="nx">startAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nx">getChangeObject</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">);</span> 
    <span class="p">},</span>
    <span class="nx">resetAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nx">getChangeObject</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">);</span> 
    <span class="p">},</span>
    <span class="nx">stopAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nx">getChangeObject</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">);</span> 
    <span class="p">},</span>
    <span class="nx">pauseAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nx">getChangeObject</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;pause&#39;</span><span class="p">);</span> 
    <span class="p">},</span>
    <span class="nx">resumeAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nx">getChangeObject</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;resume&#39;</span><span class="p">);</span> 
    <span class="p">},</span>
    <span class="nx">removeAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nx">getChangeObject</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">);</span> 
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>setProperty</strong></p>

<p>This method is used to add or modify properties of all timers based
on a condition. If the condition evaluates to <em>'true'</em> the property will be
set with the given value.</p>

<p>Parameters:</p>

<ul>
<li><p><strong>propertyName must be a Sring.</strong><br/>(Name of the propety to set)</p></li>
<li><p><strong>value must be an Anything.</strong><br/>(Value to set)</p></li>
<li><p><strong>condition must be a Function.</strong><br/>(Condition that must be fullfilled before setting the property)</p></li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="nx">setProperty</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">propertyName</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">timer</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">condition</span><span class="p">(</span><span class="nx">timer</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">array</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">timer</span><span class="p">[</span><span class="nx">propertyName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>toMins</strong></p>

<p>Parameters:</p>

<ul>
<li><strong>ms must be a Number.</strong><br/>(Milliseconds to convert to minutes)</li>
</ul>

<p><strong>Returns a Number</strong><br/>(The amount of minutes)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">toMins</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">ms</span><span class="o">/</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="mi">60</span><span class="p">));</span> 
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>toSecs</strong></p>

<p>Parameters:</p>

<ul>
<li><strong>ms must be a Number.</strong><br/>(Milliseconds to convert to seconds)</li>
</ul>

<p><strong>Returns a Number</strong><br/>(The amount of seconds)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">toSecs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nb">parseInt</span><span class="p">((</span><span class="nx">ms</span><span class="o">/</span><span class="mi">1000</span><span class="p">));</span> 
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>toMillisFraction</strong></p>

<p>Parameters:</p>

<ul>
<li><strong>ms must be a Number.</strong><br/>(Milliseconds to truncate)</li>
</ul>

<p><strong>Returns a Number</strong><br/>(Truncated milliseconds )</p></div></div><div class="code"><div class="wrapper">    <span class="nx">toMillisFraction</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="nb">parseInt</span><span class="p">((</span><span class="nx">ms</span><span class="o">%</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">);</span> 
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>formatMinutes</strong></p>

<p>Parameters:</p>

<ul>
<li><strong>ms must be a Number.</strong><br/>(Milliseconds to format)</li>
</ul>

<p><strong>Returns a String</strong><br/>(Formatted milliseconds to minutes)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">formatMinutes</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span> 
      <span class="kd">var</span> <span class="nx">mins</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toMins</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="o">%</span> <span class="mi">60</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">mins</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">mins</span> <span class="o">:</span> <span class="nx">mins</span><span class="p">;</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>formatSeconds</strong></p>

<p>Parameters:</p>

<ul>
<li><strong>ms must be a Number.</strong><br/>(Milliseconds to format)</li>
</ul>

<p><strong>Returns a String</strong><br/>(Formatted milliseconds to seconds)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">formatSeconds</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">fms</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toMillisFraction</span><span class="p">(</span><span class="nx">ms</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">secs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toSecs</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="o">%</span> <span class="mi">60</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">((</span><span class="nx">secs</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">secs</span> <span class="o">:</span> <span class="nx">secs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">fms</span><span class="p">;</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>formatMinutesSeconds</strong></p>

<p>Parameters:</p>

<ul>
<li><strong>ms must be a Number.</strong><br/>(Milliseconds to format)</li>
</ul>

<p><strong>Returns a String</strong><br/>(Formatted milliseconds to minutes:seconds)</p></div></div><div class="code"><div class="wrapper">    <span class="nx">formatMinutesSeconds</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatMinutes</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatSeconds</span><span class="p">(</span><span class="nx">ms</span><span class="p">);</span>
    <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">  <span class="p">});</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="getters-for-all-the-types-of-events-the-sound-player-can-hook-into">Getters for all the types of events the sound player can hook into</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;CREATE&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;create&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;REMOVE&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;remove&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;complete&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;REPEATE&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;repeate&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;START&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;start&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;PAUSE&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;pause&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;RESUME&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;resume&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;RESET&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;reset&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">TimerFactory</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s2">&quot;STOP&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;stop&#39;</span><span class="p">;</span> <span class="p">}</span> <span class="p">});</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">  <span class="kd">var</span> <span class="nx">getCountInState</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">state</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">result</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">applyChangeToTimersIfTrue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">timer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">timer</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

      <span class="k">if</span><span class="p">(</span><span class="nx">condition</span><span class="p">(</span><span class="nx">timer</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="k">this</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">timer</span><span class="p">[</span><span class="nx">state</span><span class="p">]();</span>   
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">applyChangeToSomeTimers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">identifier</span><span class="p">,</span> <span class="nx">identifierValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">timer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">timer</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">timer</span><span class="p">[</span><span class="nx">identifier</span><span class="p">]</span> <span class="o">===</span> <span class="nx">identifierValue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">timer</span><span class="p">[</span><span class="nx">state</span><span class="p">]();</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">applyChangeToAllTimers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">timer</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">timer</span><span class="p">[</span><span class="nx">state</span><span class="p">]();</span>
    <span class="p">}</span>
  <span class="p">}</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p style='color:#AD071D'><strong>getChangeObject</strong></p>

<p>Private method, but important enough to document.</p>

<p>This method returns on object with methods to filter which timers 
should move to a new state.</p>

<p>Parameters:</p>

<ul>
<li><strong>state must be a String.</strong><br/>(The state selected timers will go to. ej. <em>'start'</em>)</li>
</ul>

<p><strong>Returns an Object</strong><br/>(A control Object to manage all the registered Timers.)</p></div></div><div class="code"><div class="wrapper">  <span class="kd">var</span> <span class="nx">getChangeObject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p style='color:#AD071D'><strong>withName</strong></p>

<p>All the timers with a <strong>name</strong> equaling (===) <strong>value</strong> qualify to change state</p></div></div><div class="code"><div class="wrapper">      <span class="nx">withName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">applyChangeToSomeTimers</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">,</span> <span class="nx">state</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>  
      <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">      </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p style='color:#AD071D'><strong>withOwner</strong></p>

<p>All the timers with a <strong>owner</strong> equaling (===) <strong>value</strong> qualify to change state</p></div></div><div class="code"><div class="wrapper">      <span class="nx">withOwner</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">owner</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">applyChangeToSomeTimers</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">,</span> <span class="nx">state</span><span class="p">,</span> <span class="s1">&#39;owner&#39;</span><span class="p">,</span> <span class="nx">owner</span><span class="p">);</span> 
      <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p style='color:#AD071D'><strong>which</strong></p>

<p>The <strong>condition</strong> function will be evaluates for all timers, timers
that evaluate to true will qualify to change state.</p>

<p>The signature for the condition function is <strong>function(timer, index, array)</strong></p></div></div><div class="code"><div class="wrapper">      <span class="nx">which</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">applyChangeToTimersIfTrue</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">,</span> <span class="nx">state</span><span class="p">,</span> <span class="nx">condition</span><span class="p">);</span>  
      <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">            </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p style='color:#AD071D'><strong>now</strong></p>

<p>All timers qualify to change state</p></div></div><div class="code"><div class="wrapper">      <span class="nx">now</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">applyChangeToAllTimers</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">timeOuts</span><span class="p">,</span> <span class="nx">state</span><span class="p">);</span>
      <span class="p">}</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><hr /></div></div><div class="code"><div class="wrapper">    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nx">TimerFactory</span><span class="p">();</span>
<span class="p">});</span></div></div></div></div></body></html>